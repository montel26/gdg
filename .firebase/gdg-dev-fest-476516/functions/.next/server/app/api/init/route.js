(()=>{var e={};e.id=288,e.ids=[288],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5511:e=>{"use strict";e.exports=require("crypto")},5960:(e,t,s)=>{"use strict";s.r(t),s.d(t,{patchFetch:()=>g,routeModule:()=>p,serverHooks:()=>w,workAsyncStorage:()=>u,workUnitAsyncStorage:()=>l});var a={};s.r(a),s.d(a,{POST:()=>c});var r=s(6559),i=s(8088),n=s(7719),d=s(2190),o=s(7462);async function c(){try{return await (0,o.s4)(),d.NextResponse.json({success:!0,message:"Database initialized successfully"})}catch(e){return console.error("Database initialization error:",e),d.NextResponse.json({error:"Failed to initialize database"},{status:500})}}let p=new r.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/init/route",pathname:"/api/init",filename:"route",bundlePath:"app/api/init/route"},resolvedPagePath:"/home/sthembiso/Documents/Personal Projects/gdg/app/api/init/route.ts",nextConfigOutput:"",userland:a}),{workAsyncStorage:u,workUnitAsyncStorage:l,serverHooks:w}=p;function g(){return(0,n.patchFetch)({workAsyncStorage:u,workUnitAsyncStorage:l})}},6487:()=>{},7462:(e,t,s)=>{"use strict";s.d(t,{Ad:()=>S,F_:()=>w,MI:()=>l,Rd:()=>m,dS:()=>g,s4:()=>u});var a=s(9021),r=s(3873),i=s(5663);let n=(0,r.join)(process.cwd(),"data"),d=(0,r.join)(n,"gdg.json");async function o(){try{await a.promises.mkdir(n,{recursive:!0})}catch(e){}}async function c(){if("phase-production-build"===process.env.NEXT_PHASE)return{speakers:[],sessions:[],events:[],reviews:[],admins:[]};await o();try{let e=await a.promises.readFile(d,"utf-8");return JSON.parse(e)}catch(e){return{speakers:[],sessions:[],events:[],reviews:[],admins:[]}}}async function p(e){"phase-production-build"!==process.env.NEXT_PHASE&&(await o(),await a.promises.writeFile(d,JSON.stringify(e,null,2)))}async function u(){let e=await c();if(0===e.admins.length){let t=process.env.ADMIN_USERNAME||"admin",s=process.env.ADMIN_PASSWORD||"admin123";process.env.ADMIN_USERNAME&&process.env.ADMIN_PASSWORD||console.warn("⚠️  WARNING: Using default admin credentials. Please set ADMIN_USERNAME and ADMIN_PASSWORD in .env.local");let a=await i.Ay.hash(s,10),r={id:Date.now().toString(),username:t,passwordHash:a,createdAt:new Date().toISOString()};e.admins.push(r),console.log(`Created admin user: ${t}`),console.log("✅ Admin user created. Speakers, sessions, and reviews can be added via the admin panel.")}else console.log("✅ Admin user already exists.");await p(e),console.log("Database initialization complete!")}let l={getAll:async()=>(await c()).speakers.sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()),getById:async e=>(await c()).speakers.find(t=>t.id===e),create:async e=>{let t=await c(),s=new Date().toISOString(),a={...e,id:Date.now().toString()+Math.random().toString(36).substr(2,9),rating:0,reviewCount:0,createdAt:s,updatedAt:s};return t.speakers.push(a),await p(t),a},update:async(e,t)=>{let s=await c(),a=s.speakers.findIndex(t=>t.id===e);-1!==a&&(s.speakers[a]={...s.speakers[a],...t,updatedAt:new Date().toISOString()},await p(s))},delete:async e=>{let t=await c();t.speakers=t.speakers.filter(t=>t.id!==e),t.sessions=t.sessions.map(t=>({...t,speakerIds:t.speakerIds.filter(t=>t!==e)})),await p(t)}},w={getAll:async()=>(await c()).sessions.sort((e,t)=>e.startTime.localeCompare(t.startTime)),getById:async e=>(await c()).sessions.find(t=>t.id===e),create:async e=>{let t=await c(),s=new Date().toISOString(),a={...e,id:Date.now().toString()+Math.random().toString(36).substr(2,9),createdAt:s,updatedAt:s};return t.sessions.push(a),await p(t),a},update:async(e,t)=>{let s=await c(),a=s.sessions.findIndex(t=>t.id===e);-1!==a&&(s.sessions[a]={...s.sessions[a],...t,updatedAt:new Date().toISOString()},await p(s))},delete:async e=>{let t=await c();t.sessions=t.sessions.filter(t=>t.id!==e),await p(t)}},g={get:async()=>(await c()).events[0],create:async e=>{let t=await c(),s=new Date().toISOString(),a={...e,id:Date.now().toString(),createdAt:s,updatedAt:s};return t.events=[a],await p(t),a},update:async(e,t)=>{let s=await c(),a=s.events.findIndex(t=>t.id===e);-1!==a&&(s.events[a]={...s.events[a],...t,updatedAt:new Date().toISOString()},await p(s))}},m={getAll:async()=>(await c()).reviews.sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()),getBySpeakerId:async e=>(await c()).reviews.filter(t=>t.speakerId===e).sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()),getBySessionId:async e=>(await c()).reviews.filter(t=>t.sessionId===e).sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()),create:async e=>{let t=await c(),s=new Date().toISOString(),a={...e,id:Date.now().toString()+Math.random().toString(36).substr(2,9),createdAt:s};if(t.reviews.push(a),e.speakerId){let s=t.reviews.filter(t=>t.speakerId===e.speakerId),a=s.reduce((e,t)=>e+t.rating,0)/s.length,r=t.speakers.findIndex(t=>t.id===e.speakerId);-1!==r&&(t.speakers[r].rating=Math.round(10*a)/10,t.speakers[r].reviewCount=s.length)}return await p(t),a},delete:async e=>{let t=await c(),s=t.reviews.find(t=>t.id===e);if(t.reviews=t.reviews.filter(t=>t.id!==e),s&&s.speakerId){let e=t.reviews.filter(e=>e.speakerId===s.speakerId),a=e.length>0?e.reduce((e,t)=>e+t.rating,0)/e.length:0,r=t.speakers.findIndex(e=>e.id===s.speakerId);-1!==r&&(t.speakers[r].rating=Math.round(10*a)/10,t.speakers[r].reviewCount=e.length)}await p(t)}},S={getByUsername:async e=>(await c()).admins.find(t=>t.username===e),create:async e=>{let t=await c(),s={...e,id:Date.now().toString(),createdAt:new Date().toISOString()};return t.admins.push(s),await p(t),s}}},8335:()=>{},9021:e=>{"use strict";e.exports=require("fs")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[447,12],()=>s(5960));module.exports=a})();